/** @license
 * Autodesk clearx
 * Date: 2019-12-21
 * License: Apache-2.0
 *
 * Bundled dependencies (npm packages): 
 * {"package":"deepmerge@3.1.0","license":"MIT","link":"https://github.com/KyleAMathews/deepmerge"}, {"package":"fast-deep-equal@2.0.1","license":"MIT","link":"https://github.com/epoberezkin/fast-deep-equal#readme"}
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).ClearX=e()}(this,(function(){"use strict";var t=0;"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var e=function(t,e){return t(e={exports:{}},e.exports),e.exports}((function(t,e){t.exports=function(){var t=function(t){return function(t){return!!t&&"object"==typeof t}(t)&&!function(t){var r=Object.prototype.toString.call(t);return"[object RegExp]"===r||"[object Date]"===r||function(t){return t.$$typeof===e}(t)}(t)},e="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function r(t,e){return!1!==e.clone&&e.isMergeableObject(t)?i((r=t,Array.isArray(r)?[]:{}),t,e):t;var r}function n(t,e,n){return t.concat(e).map((function(t){return r(t,n)}))}function i(e,o,a){(a=a||{}).arrayMerge=a.arrayMerge||n,a.isMergeableObject=a.isMergeableObject||t;var s=Array.isArray(o);return s===Array.isArray(e)?s?a.arrayMerge(e,o,a):function(t,e,n){var o={};return n.isMergeableObject(t)&&Object.keys(t).forEach((function(e){o[e]=r(t[e],n)})),Object.keys(e).forEach((function(a){n.isMergeableObject(e[a])&&t[a]?o[a]=i(t[a],e[a],n):o[a]=r(e[a],n)})),o}(e,o,a):r(o,a)}return i.all=function(t,e){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce((function(t,r){return i(t,r,e)}),{})},i}()})),r=Array.isArray,n=Object.keys,i=Object.prototype.hasOwnProperty,o=function t(e,o){if(e===o)return!0;if(e&&o&&"object"==typeof e&&"object"==typeof o){var a,s,u,c=r(e),f=r(o);if(c&&f){if((s=e.length)!=o.length)return!1;for(a=s;0!=a--;)if(!t(e[a],o[a]))return!1;return!0}if(c!=f)return!1;var p=e instanceof Date,h=o instanceof Date;if(p!=h)return!1;if(p&&h)return e.getTime()==o.getTime();var l=e instanceof RegExp,d=o instanceof RegExp;if(l!=d)return!1;if(l&&d)return e.toString()==o.toString();var y=n(e);if((s=y.length)!==n(o).length)return!1;for(a=s;0!=a--;)if(!i.call(o,y[a]))return!1;for(a=s;0!=a--;)if(!t(e[u=y[a]],o[u]))return!1;return!0}return e!=e&&o!=o},a=function(t){return isNaN(t)?t:1*t},s=function(t,e,r){return!u(t[e],r)&&(t[e]=r,t[e]===r)},u=function(t,e){return void 0!==t&&o(t,e)},c=function(t,e,r){if(void 0===e&&(e="."),void 0===r&&(r="\\"),!t)return[];if(Array.isArray(t))return t;for(var n=[],i="",o=0,s=t.length;o<s;++o){var u=t[o];u===e&&t[o-1]!==r?(i.length>0&&n.push(a(i)),i=""):u!==r&&(i+=t[o])}return i.length>0&&n.push(a(i)),n},f=function(t,e,r){if(void 0===t)return r;if(!e||0===e.length)return t;var n=(e=c(e))[0],i=e.slice(1);return isNaN(n)||(n*=1),f(t[n],i,r)},p=function(t,e,r,n){var i=!1;if(void 0===t)return[!1,i];if(!e||0===e.length)return[!1,i];var o=(e=c(e))[0],a=e[1],u=e.slice(2);if(void 0!==a){if(!t.hasOwnProperty(o)){var f=isNaN(a)?{}:[];i=s(t,o,f)}var h=p(t[o],[a].concat(u),r,n);return[h[0],h[1]||i]}return t.hasOwnProperty(o)&&n?[!0,i]:[!0,i=s(t,o,r)]},h=function(t,e,r){return void 0===r&&(r=null),p(t,e,r,!0)},l=["push","pop","splice","shift","unshift","sort","slice"],d=function(t,e,r){for(var n=[],i=arguments.length-3;i-- >0;)n[i]=arguments[i+3];if(-1===l.indexOf(r))return!1;var o,a=f(t,e);Array.isArray(a)||p(t,e,a=[]);try{o=a[r].apply(a,n)}catch(t){}return[!0,!0,o]},y=function(t,e){for(var r=[],n=arguments.length-2;n-- >0;)r[n]=arguments[n+2];return d.apply(void 0,[t,e,"push"].concat(r))},v=function(t,e){for(var r=[],n=arguments.length-2;n-- >0;)r[n]=arguments[n+2];return d.apply(void 0,[t,e,"unshift"].concat(r))},g=function(t,e){for(var r=[],n=arguments.length-2;n-- >0;)r[n]=arguments[n+2];return d.apply(void 0,[t,e,"splice"].concat(r))},m=function(t,e){for(var r=[],n=arguments.length-2;n-- >0;)r[n]=arguments[n+2];var i=d.apply(void 0,[t,e,"slice"].concat(r));return i[2]},b=function(t,e){for(var r=[],n=arguments.length-2;n-- >0;)r[n]=arguments[n+2];return d.apply(void 0,[t,e,"sort"].concat(r))},U=function(t,e,r){void 0===r&&(r=1);var n=1*f(t,e);return isNaN(n)&&(n=0),p(t,e,n+=r)},_=function(t,e){var r=!1;if(void 0===t)return[!1,r];if(!e||0===e.length)return[!1,r];var n=(e=c(e))[0],i=e.slice(1);if(1===e.length){if(Array.isArray(t)&&!isNaN(n)){var o=t.length;t.splice(n,1),r=o!==t.length}else t.hasOwnProperty(n)&&(r=delete t[n]);return[!0,r]}return _(t[n],[].concat(i))},A=function(t,e,r,n){void 0===e&&(e="."),this.paths=t,this.delimiter=e,this.store=r,this.dataObserver=n,this.components=[],this._afterUpdateEvents=[],this._dataTransformers=[]},O={keys:{configurable:!0},dataTransformers:{configurable:!0},data:{configurable:!0},afterUpdateEvents:{configurable:!0},hasDataListener:{configurable:!0}};O.keys.get=function(){var t=this.paths;if(Array.isArray(t))return t;var e=[];if("string"==typeof t)e=[c(t,this.delimiter)];else{if("[object Object]"!==t.toString())return t;for(var r in t)t.hasOwnProperty(r)&&e.push(c(t[r],this.delimiter))}return e},A.prototype.observe=function(t){if((0!==this.components.length||t)&&!this.cancelObserver){var e=this.dataObserver,r=this.keys,n=this.updateComponents.bind(this);this.cancelDataListener=e.attachObserver(r,n)}},A.prototype.unobserve=function(){this.cancelDataListener&&(this.cancelDataListener(),delete this.cancelDataListener)},A.prototype.listenUnmount=function(t,e){var r=this;if(Array.isArray(t))return function(){};var n=t.componentWillUnmount;t.componentWillUnmount=function(){e(),"function"==typeof r.componentWillUnmount&&r.componentWillUnmount.call(t)},t.componentWillUnmount.__original=n},A.prototype.unlistenUnmount=function(t){if(t.componentWillUnmount){var e=t.componentWillUnmount.__original;e&&(t.componentWillUnmount=e)}},A.prototype.dataTransformer=function(t){var e=this;return"function"==typeof t?(this._dataTransformers.push(t),this.updateComponents(),function(){var r=e._dataTransformers.indexOf(t);r>-1&&e._dataTransformers.splice(r,1)}):function(){}},O.dataTransformers.get=function(){return this._dataTransformers.slice(0)},A.prototype.applyDataTransformers=function(t){return this._dataTransformers.forEach((function(e){try{t=e(t)}catch(r){console.log(e,"failing to transform",t)}})),t},A.prototype.updateData=function(){var t,r=this,n={},i=this.paths;if("string"==typeof i)i=c(i,this.delimiter),n=this.store.get(i);else if(Array.isArray(i))n=i.map((function(t){var e=c(t,r.delimiter);return r.store.get(e)}));else for(var o in i){var a=c(i[o],this.delimiter);n[o]=this.store.get(a)}"object"==typeof(n=this.applyDataTransformers(n))&&(t=e({},n),Object.freeze&&Object.freeze(t),n=t),this._data=n},O.data.get=function(){return this._data||this.updateData(),this._data},A.prototype.updateComponents=function(){var t=this;this.updateData(),this.components.forEach((function(e){t.assignState(e)})),this.executeAfterUpdate()},A.prototype.assignStateFC=function(t,e){var r;if(Array.isArray(t)&&(r=t[1]),r)return!!e||(t[0]=this._data,r(this._data),!0)},A.prototype.assignStateCC=function(t,e){if("function"==typeof t.setState)return e?(t.state=t.state||{},t.state.store=t.state.store||{},t.state.store=Object.assign({},t.state.store,this.data)):t.setState(Object.assign({},t.state,{store:Object.assign({},t.state.store,this.data)})),!0},A.prototype.assignStateOthers=function(t){"object"==typeof t&&(t.data=this.data)},A.prototype.assignState=function(t,e){void 0===e&&(e=!1);var r=this.assignStateFC(t,e),n=this.assignStateCC(t,e);r||n||this.assignStateOthers(t,e)},A.prototype.onUpdate=function(t){var e=this;return"function"==typeof t?(this._afterUpdateEvents.push(t),function(){var r=e._afterUpdateEvents.indexOf(t);r>-1&&e._afterUpdateEvents.splice(r,1)}):function(){}},O.afterUpdateEvents.get=function(){return this._afterUpdateEvents.slice(0)},A.prototype.executeAfterUpdate=function(){var t=this;this._afterUpdateEvents.forEach((function(e){try{e(t.data)}catch(t){console.log(t)}}))},O.hasDataListener.get=function(){return!!this.cancelDataListener},A.prototype.addMark=function(t,e){var r=t;Array.isArray(t)&&(r=t[1]),r.__segment=e},A.prototype.removeMark=function(t){var e=t;Array.isArray(t)&&(e=t[1]),delete e.__segment},Object.defineProperties(A.prototype,O);var E=function(e,r,n,i,o){this.id=r||"clearx-"+(t+=1),this.paths=e,this._helper=new A(e,n,i,o),this.delimiter=n,this.store=i,this.dataObserver=o},x={data:{configurable:!0},components:{configurable:!0},active:{configurable:!0},afterUpdateEvents:{configurable:!0},dataTransformers:{configurable:!0}};E.prototype.findComponent=function(t){if(!this._helper)return-1;Array.isArray(t)&&(t=t[1]);for(var e=this._helper.components,r=0;r<e.length;r++){var n=e[r];if(Array.isArray(n)&&(n=n[1]),t===n)return r}return-1},x.data.get=function(){return this._helper?this._helper.data:{}},x.components.get=function(){return this._helper?this._helper.components.slice(0):[]},x.active.get=function(){return!!this._helper&&this._helper.hasDataListener},x.afterUpdateEvents.get=function(){return this._helper?this._helper.afterUpdateEvents:[]},x.dataTransformers.get=function(){return this._helper?this._helper.dataTransformers:[]},E.prototype.link=function(t){if(!t)return{};var e=this._helper;if(!e)return{};var r=this.store,n=r._unlinkComponentFromAllSegments.bind(r,t),i=[this.data,n];return this.findComponent(t)>-1?i:(e.components.push(t),e.observe(this.keepSyncing),e.addMark(t,this),e.listenUnmount(t,n),e.assignState(t,!0),i)},E.prototype.unlink=function(t){if(!t)return!1;var e=this._helper;if(!e)return!1;var r=this.findComponent(t);return r>-1&&(e.removeMark(t),e.components.splice(r,1),e.unlistenUnmount(t)),0!==e.components.length||this.keepSyncing||e.unobserve(),r>-1},E.prototype.sync=function(t){return void 0===t&&(t=!0),!!this._helper&&(this.keepSyncing=t,t&&!this.active&&this._helper.observe(!0),!t&&this.active&&this._helper.unobserve(),!0)},E.prototype.unlinkAll=function(){return!!this._helper&&(this._helper.components.forEach(this.unlink.bind(this)),!0)},E.prototype.onUpdate=function(t){return this._helper?this._helper.onUpdate(t):function(){}},E.prototype.dataTransformer=function(t){return this._helper?this._helper.dataTransformer(t):function(){}},E.prototype.teardown=function(){return!this._helper||(this.unlinkAll(),this._helper.unobserve(),delete this._helper,delete this.dataObserver,this.store.removeSegment(this),!0)},Object.defineProperties(E.prototype,x);var j=function(t){this.store=t,this.listeners={},this.counter=0};j.prototype.attachObserver=function(t,e){var r=this;if(e&&t&&0!==t.length){++this.counter;var n="data-slice:"+this.counter;return this.listeners[n]={keys:t,listener:e},function(){delete r.listeners[n]}}},j.prototype.dataUpdatedAt=function(t){var e=[],r=c(t).join(">>");for(var n in this.listeners){var i=this.listeners[n],o=i.keys,a=i.listener;(o=o.filter((function(t){var e=c(t).join(">>");return e.startsWith(r)||r.startsWith(e)}))).length>0&&e.push([o,a])}e.forEach((function(t){var e=t[0],r=t[1];try{r(e)}catch(t){console.log("Error updating",r,e)}}))},j.prototype.teardown=function(){this.listeners={}};var k=function(t){this.data=t,this.segments=[],this.dataObserver=new j(this),this.delimiter=".",this.onUpdateEvents=[]};return k.prototype.triggerEvents=function(t){this.dataObserver.dataUpdatedAt(t)},k.prototype.executeUtil=function(t,e){var r=e[0],n=e[1];e[2];return n&&this.triggerEvents(t),this.executeOnUpdateEvents(n,t),r},k.prototype.get=function(t,e){return f(this.data,t,e)},k.prototype.set=function(t,e,r){return void 0===r&&(r=!1),this.executeUtil(t,p(this.data,t,e,r))},k.prototype.coalesce=function(t,e){return function(t,e,r){for(var n=0,i=e.length;n<i;++n){var o=f(t,e[n]);if(null!=o)return o}return r}(this.data,t,e)},k.prototype.empty=function(t){return this.executeUtil(t,function(t,e){var r,n=!1,i=f(t,e);if(void 0===i)return[!0,n];switch(!0){case"string"==typeof i:r="";break;case"number"==typeof i:r=0;break;case"boolean"==typeof i:r=!1;break;case Array.isArray(i):return i.length=0,[!0,0===i.length];case"object"==typeof i:for(var o in i)i.hasOwnProperty(o)&&(n=delete i[o]||n);return[!0,n]}return p(t,e,r)}(this.data,t))},k.prototype.insert=function(t,e,r){return this.executeUtil(t,function(t,e,r,n){return void 0===n?y(t,e,r):d(t,e,"splice",n,0,r)}(this.data,t,e,r))},k.prototype.push=function(t){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];return this.executeUtil(t,y.apply(void 0,[this.data,t].concat(e)))},k.prototype.unshift=function(t){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];return this.executeUtil(t,v.apply(void 0,[this.data,t].concat(e)))},k.prototype.pop=function(t){return this.executeUtil(t,(e=this.data,d(e,t,"pop")));var e},k.prototype.shift=function(t){return this.executeUtil(t,(e=this.data,d(e,t,"shift")));var e},k.prototype.splice=function(t){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];return this.executeUtil(t,g.apply(void 0,[this.data,t].concat(e)))},k.prototype.slice=function(t){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];return m.apply(void 0,[this.data,t].concat(e))},k.prototype.sort=function(t){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];return this.executeUtil(t,b.apply(void 0,[this.data,t].concat(e)))},k.prototype.ensureExists=function(t,e){return this.executeUtil(t,h(this.data,t,e))},k.prototype.delete=function(t){return this.executeUtil(t,_(this.data,t))},k.prototype.has=function(t){return e=this.data,void 0!==f(e,t);var e},k.prototype.merge=function(t,r){return this.executeUtil(t,function(t,r,n){h(t,r,Array.isArray(n)?[]:{});var i=f(t,r),o=e(i,n);return p(t,r,o)}(this.data,t,r))},k.prototype.increment=function(t,e){return this.executeUtil(t,U(this.data,t,e))},k.prototype.decrement=function(t,e){return this.executeUtil(t,function(t,e,r){return void 0===r&&(r=1),U(t,e,-1*r)}(this.data,t,e))},k.prototype.toggle=function(t){return this.executeUtil(t,(e=this.data,n=!!f(e,r=t),p(e,r,!n)));var e,r,n},k.prototype.isEqual=function(t,e){return r=this.data,n=e,i=f(r,t),o(i,n);var r,n,i},k.prototype.paths=function(t,e){var r=new E(t,e,this.delimiter,this,this.dataObserver);return this.segments.push(r),r},k.prototype.bind=function(t){void 0===t&&(t={});var e,r=t.to,n=t.afterUpdate,i=t.id,o=t.paths,a=t.dataTransformer,s=r;if(Array.isArray(s)&&(s=r[1]),e=s.__segment)return e.link(r);(e=this.paths(o,i,this.delimiter)).onUpdate(n),e.dataTransformer(a);var u=e.link(r);return Array.isArray(r)?u:e},k.prototype.removeSegment=function(t){var e=this.segments.indexOf(t);return e>-1&&(t.teardown(),this.segments.splice(e,1),!0)},k.prototype.onUpdate=function(t){var e=this;return"function"==typeof t?(this.onUpdateEvents.push(t),function(){var r=e.onUpdateEvents.indexOf(t);r>-1&&e.onUpdateEvents.splice(r,1)}):function(){}},k.prototype.executeOnUpdateEvents=function(t,e){var r=this;this.onUpdateEvents.forEach((function(n){try{n(t,e,r.data,r)}catch(t){console.log("onUpdate",n,e)}}))},k.prototype._unlinkComponentFromAllSegments=function(t){this.segments.forEach((function(e){e.unlink(t)}))},k.prototype.teardown=function(){return this.segments.forEach((function(t){t.teardown()})),this.dataObserver.teardown(),delete this.dataObserver,this.data={},!0},k}));
//# sourceMappingURL=clearx.js.map
